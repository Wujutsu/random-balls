<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random balls</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
</head>
<body style="background-color: rgb(39, 39, 39);">

    <div><button id="btnNewBall" class="btn btn-primary">Add a ball</button></div>
    <canvas id="myCanvas" width="800" height="400" style="border: 1px solid white"></canvas>
    
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="./Ball.js"></script>
    <script>
        //Init
        var canvas = document.getElementById("myCanvas");
        var ctx = canvas.getContext("2d");
        var interval = setInterval(play, 10);
        
        var tabBalls = Array();
        var tabColor = ['red', 'green', 'blue', 'yellow', 'orange', 'purple'];
        var tabSpeed = [1, 2, 3, 4];

        //Add a new ball
        $("#btnNewBall").click(function (e) { 
            e.preventDefault();
            widthBall = 10;
            posXRandom = Math.floor(Math.random() * (canvas.width - (widthBall * 2))) + (widthBall * 2);
            posYRandom = Math.floor(Math.random() * (canvas.height - (widthBall * 2))) + (widthBall * 2);
            directionX = Math.floor(Math.random() * 2);
            directionY = Math.floor(Math.random() * 2);
            color = tabColor[Math.floor(Math.random() * tabColor.length)];
            speed = tabSpeed[Math.floor(Math.random() * tabSpeed.length)];
            tabBalls.push(new Ball(widthBall, posXRandom, posYRandom, directionX, directionY, speed, color));
        });

        //Show canvas game
        function play() {
            //Refresh the canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            //Show the balls
            tabBalls.forEach(ball => {
                ctx.beginPath();
                ctx.arc(ball.posX, ball.posY, ball.width, 0, 5 * Math.PI);       
                ctx.fillStyle = ball.color;
                ctx.fill();
                ctx.closePath();

                ball.move();
                ball.collisionGame(canvas.width, canvas.height);
            });
        }
    
    </script>
    
</body>
</html>